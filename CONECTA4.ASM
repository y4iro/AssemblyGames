PINTA MACRO COLUMNA, FILA, COLOR, TEXTO, TAM
	MOV AL,00H
	MOV BH,00H
	MOV BL,COLOR
	MOV CX,TAM
	MOV DL,COLUMNA
	MOV DH,FILA
	MOV ES,DATAUSER
	MOV BP,OFFSET TEXTO
	MOV AH,13H
	INT 10H
ENDM

LIMPIA MACRO
	PUSH AX
	MOV AX,0600H
	MOV BH,0F0H
	MOV CX,0
	MOV DH,24
	MOV DL,79
	INT 10H
	POP AX
ENDM

CONVIERTE MACRO VAR,LEN
	PUSH AX
	MOV BX,LEN
	DEC BX
	MOV CX,10
	CYCLE:
	DIV CL
	ADD AH,30H
	MOV VAR+BX,AH
	XOR AH,AH
	CMP BX,0H
	JE ENDCYCLE
	DEC BX
	JMP CYCLE
	ENDCYCLE:
	POP AX
ENDM

archivo	macro carpeta,archivo,data2,tamdata,handler
	LOCAL errorF,err2,cfile,seguimos

	mov dx,offset carpeta
	mov ah,39h
	int 21h

	mov dx,offset archivo
	mov ah,3dh
	mov al,2h
	int 21h
	jc errorF
	jmp cfile

	errorF:
	mov ah,3ch
	mov cx,0
	mov dx,offset archivo
	int 21h
	jc err2

	cfile:
	mov handler,ax

	mov ah,42h
	mov bx,handler
	mov al,2
	mov cx,0
	mov dx,0
	int 21h

	mov ah,40h
	mov bx,handler
	mov dx,offset data2
	mov cx,tamdata
	int 21h

	mov ah,3eh
	mov bx,handler
	int 21h

	jmp seguimos

	err2:
	nop

	seguimos:

endm	

sacafecha macro date
	LOCAL anio
	mov ah,2ah          ;Recuperamos fecha del sys: al(dia de semana), cx(anio), dx(mes,dia)
	int 21h

	xchg bl, al         ; bl - dia de la semana 
	mov ax,000ah
	mov bh,dl           ; bh - mes 
	mov dl,0h 
	xchg dh,dl          ; dl - dia 
	xchg dl,al          ; al - dia, dh - 10h
	div dl              ; dia / 10 --> res:decenas, mod:unidades, en AX 

	add ah,30h          ; Acomodo de numero de dos digitos en ax, acomodando en ascii
	add al, 30h         ; Acomodo en ascii
	mov date+3, al      ; Se guarda en el primer y segundo numero el dia
	mov date+4, ah

	mov dx,000ah        ; Acomodando division para mes
	mov ah,00h
	mov al,bh        
	div dl              ; En ax se almacenara el mes de dos digitos
	
	add ah,30h
	add al, 30h         ; Acomodo en ascii
	mov date, al        ; Se guardan los siguientes dos numeros
	mov date+1, ah

	mov dx,000ah        ; Acomodando division para anio (1 digito)
	mov ax,cx           ; Valor del anio inicial en ax
	mov cx,4h           ; Contador
	lea si,date+9       ; Apuntador a direccion de caracteres (guarda como 2016 al final) 

	anio:
            
    	div dl           ; Division ax/10
    	add ah,30h       ; Acomodo en ascii       
    	mov [si], ah     ; Se guarda el digito del anio
    	dec si           ; Si apunta a un numero antes
    	mov ah,0h        ; Init de ah
    	dec cx           ; Contador--
    	jnz anio

endm

.model small
.stack 100H
.data

	DATAUSER DW 0
	FICHA    DB 'XXXXXX',10,8,8,8,8,8,8,'XXXXXX',10,8,8,8,8,8,8,'XXXXXX',10,8,8,8,8,8,8,'$'
	TABLERO1 DB 'XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX','$'
	TABLERO2 DB 'X      X      X      X      X      X      X      X','$'
	X        DW 0H
	PX       DB 0H,0H,0H,0H
	tablero	 DB 0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h
	turno	 DB 1h
	JUGADA   DB 0h,0h
	CONTADOR DB 0H
	CASILLA  DB 0H
	AYUDA    DB 0H
	TITULO   DB ' CONECTA 4 PARA DOS JUGADORES '
	TURNO1   DB '     TURNO DEL JUGADOR 1      '
	TURNO2   DB '     TURNO DEL JUGADOR 2      '
	GANA0    DB '            EMPATE            '
	GANA1X	 DB '      GANA EL JUGADOR 1       '
	GANA2X   DB '      GANA EL JUGADOR 2       '
	AVISO1   DB ' presiona ESC para reiniciar  '
	AVISO2	 DB ' presiona ENTER para salir    '
	AVISO3	 DB ' presiona SPACE para ayuda    '
	AVISO4   DB '                              '
	AYUDA1   DB '         INSTRUCCIONES        '
	AYUDA2	 DB ' Por turnos elige una columna,'
	AYUDA3	 DB ' la ficha de tu color  caera a'
	AYUDA4   DB ' la casilla, ganara el primero'
	AYUDA5   DB ' en completar una linea de 4. '
	AYUDA6   DB ' presiona SPACE para regresar '
	AYUDA7   DB '      JUEGA CON EL MOUSE      ' 
	carpe	 DB 'c:\examJSP',0
	arch	 DB 'c:\examJSP\conecta4.txt',0
	handler  DW ?
	archivo3 DB 'Fecha: '
	fecha    DB 0h,0h,'/',0h,0h,'/',0h,0h,0h,0h
	gana     DB ' Gano jugador: '
	ganador	 DB 0h,10,13
	archivo2 DB 'Fecha: '
	fecha2   DB 0h,0h,'/',0h,0h,'/',0h,0h,0h,0h
	gana2    DB ' EMPATE',10,13

.code
.startup

	MOV AX,@DATA
	MOV DS,AX
	MOV DATAUSER, AX
	MOV AX,0003H
	INT 10H
	MOV AX,1003H
	MOV BX,0
	INT 10H

REINICIA:
	MOV TURNO, 1H
	MOV CONTADOR,0H
	MOV TABLERO,0H
	MOV TABLERO+1,0H
	MOV TABLERO+2,0H
	MOV TABLERO+3,0H
	MOV TABLERO+4,0H
	MOV TABLERO+5,0H
	MOV TABLERO+6,0H
	MOV TABLERO+7,0H
	MOV TABLERO+8,0H
	MOV TABLERO+9,0H
	MOV TABLERO+10,0H
	MOV TABLERO+11,0H
	MOV TABLERO+12,0H
	MOV TABLERO+13,0H
	MOV TABLERO+14,0H
	MOV TABLERO+15,0H
	MOV TABLERO+16,0H
	MOV TABLERO+17,0H
	MOV TABLERO+18,0H
	MOV TABLERO+19,0H
	MOV TABLERO+20,0H
	MOV TABLERO+21,0H
	MOV TABLERO+22,0H
	MOV TABLERO+23,0H
	MOV TABLERO+24,0H
	MOV TABLERO+25,0H
	MOV TABLERO+26,0H
	MOV TABLERO+27,0H
	MOV TABLERO+28,0H
	MOV TABLERO+29,0H
	MOV TABLERO+30,0H
	MOV TABLERO+31,0H
	MOV TABLERO+32,0H
	MOV TABLERO+33,0H
	MOV TABLERO+34,0H
	MOV TABLERO+35,0H
	MOV TABLERO+36,0H
	MOV TABLERO+37,0H
	MOV TABLERO+38,0H
	MOV TABLERO+39,0H
	MOV TABLERO+40,0H
	MOV TABLERO+41,0H

	;PINTAMOS EL TABLERO
	LIMPIA
	PINTA 50,7,11110100B,TITULO,30
	sacafecha fecha
	PINTA 61,5,11110100B,FECHA,10
	sacafecha fecha2
	PINTA 50,10,01001111B,TURNO1,30
	PINTA 50,13,11110100B,AVISO1,30
	PINTA 50,14,11110100B,AVISO2,30
	PINTA 50,15,11110100B,AVISO3,30
	PINTA 50,16,11110100B,AVISO4,30
	PINTA 50,17,11110100B,AVISO4,30
	PINTA 50,18,11110100B,AVISO4,30
	PINTA 50,19,11110100B,AVISO4,30
	PINTA 0,0,10010001B,TABLERO1,50
	PINTA 0,1,10010001B,TABLERO2,50
	PINTA 0,2,10010001B,TABLERO2,50
	PINTA 0,3,10010001B,TABLERO2,50
	PINTA 0,4,10010001B,TABLERO1,50
	PINTA 0,5,10010001B,TABLERO2,50
	PINTA 0,6,10010001B,TABLERO2,50
	PINTA 0,7,10010001B,TABLERO2,50
	PINTA 0,8,10010001B,TABLERO1,50
	PINTA 0,9,10010001B,TABLERO2,50
	PINTA 0,10,10010001B,TABLERO2,50
	PINTA 0,11,10010001B,TABLERO2,50
	PINTA 0,12,10010001B,TABLERO1,50
	PINTA 0,13,10010001B,TABLERO2,50
	PINTA 0,14,10010001B,TABLERO2,50
	PINTA 0,15,10010001B,TABLERO2,50
	PINTA 0,16,10010001B,TABLERO1,50
	PINTA 0,17,10010001B,TABLERO2,50
	PINTA 0,18,10010001B,TABLERO2,50
	PINTA 0,19,10010001B,TABLERO2,50
	PINTA 0,20,10010001B,TABLERO1,50
	PINTA 0,21,10010001B,TABLERO2,50
	PINTA 0,22,10010001B,TABLERO2,50
	PINTA 0,23,10010001B,TABLERO2,50
	PINTA 0,24,10010001B,TABLERO1,50

	;HABILITAMOS EL MOUSE
	MOV AX,1
	INT 33H

	;SACANDO LAS COORDENADAS DEL MOUSE
	MOV AX,1003H
	MOV BX,0
	INT 10H

JUEGO:

	MOV JUGADA,0
	MOV JUGADA+1,0
	MOV AH,0BH
	INT 21H
	CMP AL,00H
	JNE BOTON

	CMP TURNO,0
	JE  JUEGO

	; LECTURA COORDENADAS MOUSE
	MOV AX,3
	INT 33H
	MOV AX,CX
	MOV X,CX
	CONVIERTE PX,4
	;PINTA 30,6,11110000B,PX,4

	MOV AX,3
	INT 33H
	CMP BX,1
	JZ  CLICKX
	JMP JUEGO

CLICKX: JMP CLICK
	 
BOTON:
	MOV AH,02H
	MOV DL,08H
	INT 21H
	MOV DL,00H
	INT 21H
	MOV AX,0000H
	INT 16H
	CMP AL,0DH   ;ENTER
	JE  TERMINA2
	CMP AL,1BH   ;ESCAPE
	JE  REINICIA2
	CMP AL,20H   ;SPACE
	JE  INSTRUCCIONES  
	JMP JUEGO     

REINICIA2: JMP REINICIA
TERMINA2: JMP TERMINA
INSTRUCCIONES2X: JMP INSTRUCCIONES2

INSTRUCCIONES:
	CMP AYUDA,0
	JE  INSTRUCCIONES2X
	MOV AYUDA,0
	PINTA 50,13,11110100B,AVISO1,30
	PINTA 50,14,11110100B,AVISO2,30
	PINTA 50,15,11110100B,AVISO3,30
	PINTA 50,16,11110100B,AVISO4,30
	PINTA 50,17,11110100B,AVISO4,30
	PINTA 50,18,11110100B,AVISO4,30	
	PINTA 50,19,11110100B,AVISO4,30
	JMP JUEGO

INSTRUCCIONES2:
	MOV AYUDA,1
	PINTA 50,13,11110100B,AYUDA1,30
	PINTA 50,14,11110100B,AYUDA2,30
	PINTA 50,15,11110100B,AYUDA3,30
	PINTA 50,16,11110100B,AYUDA4,30
	PINTA 50,17,11110100B,AYUDA5,30
	PINTA 50,18,11110100B,AYUDA6,30
	PINTA 50,19,11110100B,AYUDA7,30
	JMP JUEGO

CLICK:
	CMP X,60
	JBE COL1X
	CMP X,116
	JBE COL2X
	CMP X,172
	JBE COL3X
	CMP X,228
	JBE COL4X
	CMP X,284
	JBE COL5X
	CMP X,340
	JBE COL6X
	CMP X,396
	JBE COL7X
	JMP JUEGO

COL1X: JMP COL1
COL2X: JMP COL2
COL3X: JMP COL3
COL4X: JMP COL4
COL5X: JMP COL5
COL6X: JMP COL6
COL7X: JMP COL7

COL1:
	MOV JUGADA,1
	CMP TABLERO+35,0
	JNE COL1A
	MOV AL,TURNO
	MOV TABLERO+35,AL
	MOV CASILLA,35
	MOV JUGADA+1,21
	JMP FIL
		COL1A:
	CMP TABLERO+28,0
	JNE COL1B
	MOV AL,TURNO
	MOV TABLERO+28,AL
	MOV CASILLA,28
	MOV JUGADA+1,17
	JMP FIL
		COL1B:
	CMP TABLERO+21,0
	JNE COL1C
	MOV AL,TURNO
	MOV TABLERO+21,AL
	MOV CASILLA,21
	MOV JUGADA+1, 13
	JMP FIL
		COL1C:
	CMP TABLERO+14,0
	JNE COL1D
	MOV AL,TURNO
	MOV TABLERO+14,AL
	MOV CASILLA,14
	MOV JUGADA+1, 9
	JMP FIL
		COL1D:
	CMP TABLERO+7,0
	JNE COL1E
	MOV AL,TURNO
	MOV TABLERO+7,AL
	MOV CASILLA,7
	MOV JUGADA+1, 5
	JMP FIL
		COL1E:
	CMP TABLERO+0,0
	JNE JUEGOX1
	MOV AL,TURNO
	MOV TABLERO+0,AL
	MOV CASILLA,0
	MOV JUGADA+1,1
	JMP FIL
JUEGOX1: JMP JUEGO

COL2:
	MOV JUGADA,8
	CMP TABLERO+36,0
	JNE COL2A
	MOV AL,TURNO
	MOV TABLERO+36,AL
	MOV CASILLA,36
	MOV JUGADA+1,21
	JMP FIL
		COL2A:
	CMP TABLERO+29,0
	JNE COL2B
	MOV AL,TURNO
	MOV TABLERO+29,AL
	MOV CASILLA,29
	MOV JUGADA+1,17
	JMP FIL
		COL2B:
	CMP TABLERO+22,0
	JNE COL2C
	MOV AL,TURNO
	MOV TABLERO+22,AL
	MOV CASILLA,22
	MOV JUGADA+1, 13
	JMP FIL
		COL2C:
	CMP TABLERO+15,0
	JNE COL2D
	MOV AL,TURNO
	MOV TABLERO+15,AL
	MOV CASILLA,15
	MOV JUGADA+1, 9
	JMP FIL
		COL2D:
	CMP TABLERO+8,0
	JNE COL2E
	MOV AL,TURNO
	MOV TABLERO+8,AL
	MOV CASILLA,8
	MOV JUGADA+1, 5
	JMP FIL
		COL2E:
	CMP TABLERO+1,0
	JNE JUEGOX2
	MOV AL,TURNO
	MOV TABLERO+1,AL
	MOV CASILLA,1
	MOV JUGADA+1,1
	JMP FIL
JUEGOX2: JMP JUEGO

COL3:
	MOV JUGADA,15
	CMP TABLERO+37,0
	JNE COL3A
	MOV AL,TURNO
	MOV TABLERO+37,AL
	MOV CASILLA,37
	MOV JUGADA+1,21
	JMP FIL
		COL3A:
	CMP TABLERO+30,0
	JNE COL3B
	MOV AL,TURNO
	MOV TABLERO+30,AL
	MOV CASILLA,30
	MOV JUGADA+1,17
	JMP FIL
		COL3B:
	CMP TABLERO+23,0
	JNE COL3C
	MOV AL,TURNO
	MOV TABLERO+23,AL
	MOV CASILLA,23
	MOV JUGADA+1, 13
	JMP FIL
		COL3C:
	CMP TABLERO+16,0
	JNE COL3D
	MOV AL,TURNO
	MOV TABLERO+16,AL
	MOV CASILLA,16
	MOV JUGADA+1, 9
	JMP FIL
		COL3D:
	CMP TABLERO+9,0
	JNE COL3E
	MOV AL,TURNO
	MOV TABLERO+9,AL
	MOV CASILLA,9
	MOV JUGADA+1, 5
	JMP FIL
		COL3E:
	CMP TABLERO+2,0
	JNE JUEGOX3
	MOV AL,TURNO
	MOV TABLERO+2,AL
	MOV CASILLA,2
	MOV JUGADA+1,1
	JMP FIL
JUEGOX3: JMP JUEGO


COL4:
	MOV JUGADA,22
	CMP TABLERO+38,0
	JNE COL4A
	MOV AL,TURNO
	MOV TABLERO+38,AL
	MOV CASILLA,38
	MOV JUGADA+1,21
	JMP FIL
		COL4A:
	CMP TABLERO+31,0
	JNE COL4B
	MOV AL,TURNO
	MOV TABLERO+31,AL
	MOV CASILLA,31
	MOV JUGADA+1,17
	JMP FIL
		COL4B:
	CMP TABLERO+24,0
	JNE COL4C
	MOV AL,TURNO
	MOV TABLERO+24,AL
	MOV CASILLA,24
	MOV JUGADA+1, 13
	JMP FIL
		COL4C:
	CMP TABLERO+17,0
	JNE COL4D
	MOV AL,TURNO
	MOV TABLERO+17,AL
	MOV CASILLA,17
	MOV JUGADA+1, 9
	JMP FIL
		COL4D:
	CMP TABLERO+10,0
	JNE COL4E
	MOV AL,TURNO
	MOV TABLERO+10,AL
	MOV CASILLA,10
	MOV JUGADA+1, 5
	JMP FIL
		COL4E:
	CMP TABLERO+3,0
	JNE JUEGOX4
	MOV AL,TURNO
	MOV TABLERO+3,AL
	MOV CASILLA,3
	MOV JUGADA+1,1
	JMP FIL
JUEGOX4: JMP JUEGO

COL5:
	MOV JUGADA,29
	CMP TABLERO+39,0
	JNE COL5A
	MOV AL,TURNO
	MOV TABLERO+39,AL
	MOV CASILLA,39
	MOV JUGADA+1,21
	JMP FIL
		COL5A:
	CMP TABLERO+32,0
	JNE COL5B
	MOV AL,TURNO
	MOV TABLERO+32,AL
	MOV CASILLA,32
	MOV JUGADA+1,17
	JMP FIL
		COL5B:
	CMP TABLERO+25,0
	JNE COL5C
	MOV AL,TURNO
	MOV TABLERO+25,AL
	MOV CASILLA,25
	MOV JUGADA+1, 13
	JMP FIL
		COL5C:
	CMP TABLERO+18,0
	JNE COL5D
	MOV AL,TURNO
	MOV TABLERO+18,AL
	MOV CASILLA,18
	MOV JUGADA+1, 9
	JMP FIL
		COL5D:
	CMP TABLERO+11,0
	JNE COL5E
	MOV AL,TURNO
	MOV TABLERO+11,AL
	MOV CASILLA,11
	MOV JUGADA+1, 5
	JMP FIL
		COL5E:
	CMP TABLERO+4,0
	JNE JUEGOX5
	MOV AL,TURNO
	MOV TABLERO+4,AL
	MOV CASILLA,4
	MOV JUGADA+1,1
	JMP FIL
JUEGOX5: JMP JUEGO

COL6:
	MOV JUGADA,36
	CMP TABLERO+40,0
	JNE COL6A
	MOV AL,TURNO
	MOV TABLERO+40,AL
	MOV CASILLA,40
	MOV JUGADA+1,21
	JMP FIL
		COL6A:
	CMP TABLERO+33,0
	JNE COL6B
	MOV AL,TURNO
	MOV TABLERO+33,AL
	MOV CASILLA,33
	MOV JUGADA+1,17
	JMP FIL
		COL6B:
	CMP TABLERO+26,0
	JNE COL6C
	MOV AL,TURNO
	MOV TABLERO+26,AL
	MOV CASILLA,26
	MOV JUGADA+1, 13
	JMP FIL
		COL6C:
	CMP TABLERO+19,0
	JNE COL6D
	MOV AL,TURNO
	MOV TABLERO+19,AL
	MOV CASILLA,19
	MOV JUGADA+1, 9
	JMP FIL
		COL6D:
	CMP TABLERO+12,0
	JNE COL6E
	MOV AL,TURNO
	MOV TABLERO+12,AL
	MOV CASILLA,12
	MOV JUGADA+1, 5
	JMP FIL
		COL6E:
	CMP TABLERO+5,0
	JNE JUEGOX6
	MOV AL,TURNO
	MOV TABLERO+5,AL
	MOV CASILLA,5
	MOV JUGADA+1,1
	JMP FIL
JUEGOX6: JMP JUEGO

COL7:
	MOV JUGADA,43
	CMP TABLERO+41,0
	JNE COL7A
	MOV AL,TURNO
	MOV TABLERO+41,AL
	MOV CASILLA,41
	MOV JUGADA+1,21
	JMP FIL
		COL7A:
	CMP TABLERO+34,0
	JNE COL7B
	MOV AL,TURNO
	MOV TABLERO+34,AL
	MOV CASILLA,34
	MOV JUGADA+1,17
	JMP FIL
		COL7B:
	CMP TABLERO+27,0
	JNE COL7C
	MOV AL,TURNO
	MOV TABLERO+27,AL
	MOV CASILLA,27
	MOV JUGADA+1, 13
	JMP FIL
		COL7C:
	CMP TABLERO+20,0
	JNE COL7D
	MOV AL,TURNO
	MOV TABLERO+20,AL
	MOV CASILLA,20
	MOV JUGADA+1, 9
	JMP FIL
		COL7D:
	CMP TABLERO+13,0
	JNE COL7E
	MOV AL,TURNO
	MOV TABLERO+13,AL
	MOV CASILLA,13
	MOV JUGADA+1, 5
	JMP FIL
		COL7E:
	CMP TABLERO+6,0
	JNE JUEGOX7
	MOV AL,TURNO
	MOV TABLERO+6,AL
	MOV CASILLA,6
	MOV JUGADA+1,1
	JMP FIL
JUEGOX7: JMP JUEGO

FIL:
	CMP TURNO,1
	JNE  FIL2
	MOV TURNO,2
	PINTA JUGADA,JUGADA+1,01000100B,FICHA,39 ;RED
	PINTA 50,10,11100000B,TURNO2,30
	JMP LIBERAI

FIL2:
	MOV TURNO,1
	PINTA JUGADA,JUGADA+1,11101110B,FICHA,39 ;YELLOW
	PINTA 50,10,01001111B,TURNO1,30


LIBERAI:
	MOV AH,CONTADOR
	ADD AH,1
	MOV CONTADOR,AH
	call PUNTO
	CMP AH, 42
	JE  EMPATE

LIBERA:
	MOV AX,3
	INT 33H
	CMP BX,0
	JE JUEGOXA
	JMP LIBERA

EMPATE:
	MOV TURNO,0
	PINTA 50,10,00011001B,GANA0,30
	archivo carpe,arch,archivo2,26,handler

JUEGOXA:
	JMP JUEGO

TERMINA:

.exit

PUNTO PROC NEAR

	CMP CASILLA,20
	JG  CASO2

CASO1: ;VERTICAL
	MOV BX,0H
	MOV BL,CASILLA
	ADD BL,7
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO2
	ADD BL,14
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO2
	ADD BL,21
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO2
	CMP TURNO,1
	JE  VICTORIA2X
	JMP VICTORIA1

VICTORIA2X:JMP VICTORIA2
CASO2BISX:JMP CASO2BIS

CASO2: ; DIAGONAL IZQUIERDA
	MOV BX,0H
	MOV DL,1
	MOV BL,CASILLA
	ADD BL,6
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO2BISX
	CMP CL,6
	JE  CASO2BISX
	CMP CL,13
	JE  CASO2BISX
	CMP CL,20
	JE  CASO2BISX
	CMP CL,27
	JE  CASO2BISX
	CMP CL,34
	JE  CASO2BISX
	CMP CL,41
	JGE CASO2BISX
	ADD DL,1
	ADD BL,12
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO2BISX
	CMP CL,6
	JE  CASO2BISX
	CMP CL,13
	JE  CASO2BISX
	CMP CL,20
	JE  CASO2BISX
	CMP CL,27
	JE  CASO2BISX
	CMP CL,34
	JE  CASO2BISX
	CMP CL,41
	JGE CASO2BISX
	ADD DL,1
	ADD BL,18
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO2BIS
	CMP CL,6
	JE  CASO2BIS
	CMP CL,13
	JE  CASO2BIS
	CMP CL,20
	JE  CASO2BIS
	CMP CL,27
	JE  CASO2BIS
	CMP CL,34
	JE  CASO2BIS
	CMP CL,41
	JGE CASO2BIS
	CMP TURNO,1
	JE  VICTORIA2XA
	JMP VICTORIA1

VICTORIA2XA: JMP VICTORIA2
CASO3X: JMP CASO3

CASO2BIS: 
	MOV BX,0H
	MOV BL,CASILLA
	SUB BL,6
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO3X
	CMP CL,35
	JE  CASO3X
	CMP CL,28
	JE  CASO3X
	CMP CL,21
	JE  CASO3X
	CMP CL,14
	JE  CASO3X
	CMP CL,7
	JE  CASO3X
	CMP CL,0
	JBE CASO3X
	ADD DL,1
	CMP DL,4
	JE  VICTORIA2XA
	SUB BL,12
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO3
	CMP CL,35
	JE  CASO3
	CMP CL,28
	JE  CASO3
	CMP CL,21
	JE  CASO3
	CMP CL,14
	JE  CASO3
	CMP CL,7
	JE  CASO3
	CMP CL,0
	JBE CASO3
	ADD DL,1
	CMP DL,4
	JE  CASO2VIC
	SUB BL,18
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO3
	CMP CL,35
	JE  CASO3
	CMP CL,28
	JE  CASO3
	CMP CL,21
	JE  CASO3
	CMP CL,14
	JE  CASO3
	CMP CL,7
	JE  CASO3
	CMP CL,0
	JBE CASO3
CASO2VIC:
	CMP TURNO,1
	JE  VICTORIA2XB
	JMP VICTORIA1

VICTORIA2XB: JMP VICTORIA2


VICTORIA3X:JMP VICTORIA2
CASO3BISX:JMP CASO3BIS

CASO3: ; DIAGONAL DERECHA
	MOV BX,0H
	MOV DL,1
	MOV BL,CASILLA
	ADD BL,8
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO3BISX
	CMP CL,7
	JE  CASO3BISX
	CMP CL,14
	JE  CASO3BISX
	CMP CL,21
	JE  CASO3BISX
	CMP CL,28
	JE  CASO3BISX
	CMP CL,35
	JE  CASO3BISX
	CMP CL,42
	JGE CASO3BISX
	ADD DL,1
	ADD BL,16
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO3BISX
	CMP CL,7
	JE  CASO3BISX
	CMP CL,14
	JE  CASO3BISX
	CMP CL,21
	JE  CASO3BISX
	CMP CL,28
	JE  CASO3BISX
	CMP CL,35
	JE  CASO3BISX
	CMP CL,42
	JGE CASO3BISX
	ADD DL,1
	ADD BL,24
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO3BIS
	CMP CL,7
	JE  CASO3BIS
	CMP CL,14
	JE  CASO3BIS
	CMP CL,21
	JE  CASO3BIS
	CMP CL,28
	JE  CASO3BIS
	CMP CL,35
	JE  CASO3BIS
	CMP CL,42
	JGE CASO3BIS
	CMP TURNO,1
	JE  VICTORIA3XA
	JMP VICTORIA1

VICTORIA3XA: JMP VICTORIA2
CASO4X: JMP CASO4

CASO3BIS: 
	MOV BX,0H
	MOV BL,CASILLA
	SUB BL,8
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO4X
	CMP CL,34
	JE  CASO4X
	CMP CL,27
	JE  CASO4X
	CMP CL,20
	JE  CASO4X
	CMP CL,13
	JE  CASO4X
	CMP CL,6
	JE  CASO4X
	CMP CL,0
	JB  CASO4X
	ADD DL,1
	CMP DL,4
	JE  VICTORIA3XA
	SUB BL,16
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO4
	CMP CL,34
	JE  CASO4
	CMP CL,27
	JE  CASO4
	CMP CL,20
	JE  CASO4
	CMP CL,13
	JE  CASO4
	CMP CL,6
	JE  CASO4
	CMP CL,0
	JB  CASO4
	ADD DL,1
	CMP DL,4
	JE  CASO3VIC
	SUB BL,24
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO4
	CMP CL,34
	JE  CASO4
	CMP CL,27
	JE  CASO4
	CMP CL,20
	JE  CASO4
	CMP CL,13
	JE  CASO4
	CMP CL,6
	JE  CASO4
	CMP CL,0
	JB  CASO4
CASO3VIC:
	CMP TURNO,1
	JE  VICTORIA3XB
	JMP VICTORIA1

VICTORIA3XB: JMP VICTORIA2
CASO4BISX: JMP CASO4BIS

CASO4: ; HORIZONTAL
	MOV BX,0H
	MOV DL,1
	MOV BL,CASILLA
	SUB BL,1
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO4BISX
	CMP CL,6
	JE  CASO4BISX
	CMP CL,13
	JE  CASO4BISX
	CMP CL,20
	JE  CASO4BISX
	CMP CL,27
	JE  CASO4BISX
	CMP CL,34
	JE  CASO4BISX
	CMP CL,41
	JGE CASO4BISX
	ADD DL,1
	SUB BL,2
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO4BISX
	CMP CL,6
	JE  CASO4BISX
	CMP CL,13
	JE  CASO4BISX
	CMP CL,20
	JE  CASO4BISX
	CMP CL,27
	JE  CASO4BISX
	CMP CL,34
	JE  CASO4BISX
	CMP CL,41
	JGE CASO4BISX
	ADD DL,1
	SUB BL,3
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE CASO4BIS
	CMP CL,6
	JE  CASO4BIS
	CMP CL,13
	JE  CASO4BIS
	CMP CL,20
	JE  CASO4BIS
	CMP CL,27
	JE  CASO4BIS
	CMP CL,34
	JE  CASO4BIS
	CMP CL,41
	JGE CASO4BIS
	CMP TURNO,1
	JE  VICTORIA4XA
	JMP VICTORIA1

VICTORIA4XA: JMP VICTORIA2
NEXTX: JMP NEXT

CASO4BIS: 
	MOV BX,0H
	MOV BL,CASILLA
	ADD BL,1
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE NEXTX
	CMP CL,35
	JE  NEXTX
	CMP CL,28
	JE  NEXTX
	CMP CL,21
	JE  NEXTX
	CMP CL,14
	JE  NEXTX
	CMP CL,7
	JE  NEXTX
	CMP CL,0
	JBE NEXTX
	ADD DL,1
	CMP DL,4
	JE  VICTORIA4XA
	ADD BL,2
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE NEXTX
	CMP CL,35
	JE  NEXTX
	CMP CL,28
	JE  NEXTX
	CMP CL,21
	JE  NEXTX
	CMP CL,14
	JE  NEXTX
	CMP CL,7
	JE  NEXTX
	CMP CL,0
	JBE NEXTX
	ADD DL,1
	CMP DL,4
	JE  CASO4VIC
	ADD BL,3
	MOV CL,BL
	MOV AL,TABLERO+BX
	MOV BL,CASILLA
	CMP TABLERO+BX,AL
	JNE NEXT2
	CMP CL,35
	JE  NEXT2
	CMP CL,28
	JE  NEXT2
	CMP CL,21
	JE  NEXT2
	CMP CL,14
	JE  NEXT2
	CMP CL,7
	JE  NEXT2
	CMP CL,0
	JBE NEXT2

NEXT2: JMP NEXT

CASO4VIC:
	CMP TURNO,1
	JE  VICTORIA2X2
	JMP VICTORIA1

VICTORIA2X2: JMP VICTORIA2

VICTORIA1:
	MOV ganador,31h
	MOV TURNO,0
	PINTA 0,0,11110000B,ganador,3
	PINTA 50,10,01001111B,GANA1X,30
	archivo carpe,arch,archivo3,35,handler
	JMP NEXT

VICTORIA2:
	MOV ganador,32h
	MOV TURNO,0
	PINTA 50,10,11100000B,GANA2X,30
	PINTA 0,0,11110000B,archivo3,35
	archivo carpe,arch,archivo3,35,handler

NEXT:
RET
PUNTO ENDP

END


